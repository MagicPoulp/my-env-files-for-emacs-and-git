
--> This guide explains how to install LineageOS (open source Android) 21 on Samsung Galaxy S10
From Debian or Ubuntu Linux

THe model I have does not have a fastboot mode at all but it has a download mode and a recovery mode from Samsung.
THe download mode allows to flash a recovery from Lineage os that can run a fastboot mode and do other things like install non official binaries
using adb sideload

Note on nice Lineage features:
Lineage allows to have security updates on devices that Samsung stopped to support for security updates.
Lineage allows to have a newer Android version.
Lineage is secure due to its open source nature (Like Linux kernel, or Debian). A few security companies support it.
LineageOS 21 (Android 14) when it starts, it allows to copy all settings from another android using bluetooth using a qr code that one phone takes with the camera (we do not have this at startup on the original Android 12 after a factory reset)
LineageOS allows to install old Androids for testing purpose

1. preparation and set OEM unlock

Back up all data so you do not risk losing data
Enable debug mode in android settings pressing 7 times build version
In developer mode set usb mode and set OEM unlock, that is the thing that protects flashing another android

Remember that pressing all buttons will shut down the phone if you are stuck

After later reboots, you will see OEM enable. And if something does not work later, go back to this step and check it.

Install adb heimdall-flash and fastboot
note: adb could be use from android studio

adb is to run commands on the device and to push files and to reboot in download mode
heimdall is to flash the recovery.img
fastboot is to flash all remaining .img after booting in recovery

sudo apt update && sudo apt install default-jdk
sudo apt install android-tools-adb && sudo apt install android-tools-fastboot
sudo apt install heimdall-flash

Download all the files for lineagesOS from the website, and pick the right device. All files are important.
Pick the latest Lineage version you can find.
Download gapps of the right android version. it is for goole mail apps, etc and recommended by guides.

2. Enter Download mode

Download mode is a mode that allows using heimdall, a flash program for Linus

It depends on devices,

volume down + bixy + plug in USB cable that is connected to the computer, enter download mode

3. unlock bootloader

It documents one the screens what you can do.
In download mode pressing volume up for a long time will unlock the bootloader, to allow installing and flashing

4. start again android that you still works, and use the adb command to start in a better version of download mode with less text
~/Android/Sdk/platform-tools/adb reboot download

To enter Recovery mode
restart from volume mode that allows volume up + bixy + power for a long time and it enters the recovery mode
lineageos has a recovery you can flash

volume down + power

heimdall can be installed on debian
it is heimdall that can flash the recovery
be sure to have oem unlock in debug options of android, then in download mode boot, unlock bootloader
then if your reboot enough and wipe data then heimdall will have no error and can flash
use "adb reboot download"
to enter a good mode for the download mode so you can flash with heimdall

To wipe data if you have an error, you can enter the recovery mode of Samsung. The preinstalled one.
heimdall flash --RECOVERY recovery.img --no-reboot

The --no-reboot is important so you have time to leave the download mode and immediately press the right buttons for the recovery mode.
If you are not fast enough, it will erase what you ahve just flashed when rebooting. This trick was found on link 2 at the end.

For me, heimdall had an error "ERROR: Failed to receive session end confirmation!"
and on the phone screen it said only official binaries are allowed.
Then I could make it work without error.

For this kind of error, it is important to reboot in download mode using adb
adb reboot download, and this may need to be down after a standard android startup.

so I erased data in the samsung recovery mode, and I check OEM unlock is well set.
It is important you do not skip the bootloader unlock above.

5. trick to enter recovery mode
at this step you are in download mode and jsut flashed with heimdall a recovery.img from lineage
press volume down + bixy
it will leave the download mode and reboot
as soon as the screeen change, press very fast volume up + bixy + power, and keep pressing for 20s until the phone enters recovery mode

6. In recovery mode
If ever you need adb, note that the recovery mode has an option to enable adb
But you should not enable it if you do not need it since it can affect the sideload installation which is another adb mode

you will have the lineage logo on top
wipe all data, it is safe
then enter fastboot in the menu
it takes a long time to boot it.

Then use the fastboot command from debian to flash all filse

fastboot flash boot boot.img
fastboot flash dtbo dtbo.img
fastboot flash dtb dtb.img
fastboot flash super_empty super_empty.img
fastboot flash vbmeta vbmeta.img

the super_empty may fail but it is not important
and the recovery you do not need it yo ualready have it.

now reboot in recovery mode

7. install programs

be sure the gapps has the corresponding android version number.
rename the lineageos zip in LINE.zip
and rename the gapps.zip in MIND.zip
it prevents bugs to have shorter paths it is recommended by all guides

TWRP, another recovery image, uses adb push to /sdcard, but TWRP does not work on Android 10+
With the recovery image from lineageOS, we use adb sideload

You need to select in the recovery mode menu:
Apply update
then go to adb Sideload and in sub-menues
you must go deep so that the sideload is activated
when you run adb devices it should say sideload.
adb devices can say unauthorized, recovery (if you do enable adb in the menu), or sideload

Now run sideload on the linage zip
do not check to reboot
~/Android/Sdk/platform-tools/adb sideload LINE.zip

Then install gapps
~/Android/Sdk/platform-tools/adb sideload MIND.zip

Then reboot.
And you will have to leave OEM unlocked and bootloader unlocked forever. If you disable it from the download mode, it will block the restart in a loop and it will be difficult (but possible) to shutdown and then to set it back from the step above (long press on volume button)

The first time it may ask to wipe data and to reboot.
Leave it time with the rotating logo.

Then Lineage works starts well.
Be sure to check the right options and not not go too fast,
like the checkbox auto updating the recovery image when updating.


-----------------------------------------------

useful adb commands:
If ever you need adb, note that the recovery mode has an option to enable adb

~/Android/Sdk/platform-tools/adb devices
~/Android/Sdk/platform-tools/adb shell uname -m
~/Android/Sdk/platform-tools/adb devices
~/Android/Sdk/platform-tools/adb reboot download

one can see all the partitions using this print command, but in download mode only
heimdall print-pit --no-reboot

one can set a device in root using "magisk" but it is not recommended to have root

NOTE:

Better use the recovery.img from Lineage's website than to use TWRP.
usual twrp on the internet that is more powerfull to perform the installation
However twrp has a problem with dynamic partitions
https://twrp.me/site/update/2019/10/23/twrp-and-android-10.html

---

archive des anciennes versions de LineageOS
https://lineage-archive.timschumi.net/#beyond

---

Links that I used:

for the Linux method, but I had to adapt it for my device:
https://forum.ubuntu-fr.org/viewtopic.php?id=2032781

to debug starting in recovery mode
https://www.reddit.com/r/LineageOS/comments/x1ub8c/custom_lineageos_recovery_img_using_heimdall/

the heimdall error about bad download mode not launched by adb as it should
https://android.stackexchange.com/questions/130392/heimdall-error-protocol-initialisation-failed-on-ubuntu

the heimdall error about OEM
https://www.reddit.com/r/LineageOS/comments/hpifqk/error_failed_to_receive_session_end_confirmation/

how to start download mode for Samsung Galaxy 10, it depends on the device
https://www.youtube.com/watch?v=8h1NWWpas8M

